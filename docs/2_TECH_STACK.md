# ê¸°ìˆ  ìŠ¤íƒ ë° ì•„í‚¤í…ì²˜ ì„¤ê³„

## ğŸ“‹ ê°œìš”

Figma ë””ìì¸ ì‹œìŠ¤í…œì—ì„œ PNG/SVG ìŠ¤í”„ë¼ì´íŠ¸ ì‹œíŠ¸ë¥¼ ìë™ ìƒì„±í•˜ëŠ” Node.js + TypeScript CLI ë„êµ¬ì˜ ê¸°ìˆ  ìŠ¤íƒ ë° ì•„í‚¤í…ì²˜ ì„¤ê³„ ë¬¸ì„œì…ë‹ˆë‹¤.

**í•µì‹¬ ì›ì¹™**: ì •í™•ì„±(Correctness), ìœ ì§€ë³´ìˆ˜ì„±(Maintainability), ëª…í™•í•œ ì—ëŸ¬ UX

---

## 1. ê¸°ìˆ  ìŠ¤íƒ ìš”ì•½

### 1.1 í•µì‹¬ ê¸°ìˆ 

| ì¹´í…Œê³ ë¦¬ | ì„ íƒ | ë²„ì „ | ê·¼ê±° |
|---------|-----|------|------|
| **Runtime** | Node.js | 20 LTS | ë„¤ì´í‹°ë¸Œ fetch API, ì•ˆì •ì  ESM, 2026ë…„ê¹Œì§€ ì¥ê¸° ì§€ì› |
| **Language** | TypeScript | 5.x | ì—„ê²©í•œ íƒ€ì… ì‹œìŠ¤í…œìœ¼ë¡œ ì •í™•ì„± ë³´ì¥, ìš°ìˆ˜í•œ IDE ì§€ì› |
| **Package Manager** | pnpm | 8.x | ë¹ ë¥¸ ì†ë„, ë””ìŠ¤í¬ íš¨ìœ¨ì„±, ì—„ê²©í•œ ì˜ì¡´ì„± í•´ê²° |
| **Build Tool** | tsup | 8.x | ì„¤ì • ë¶ˆí•„ìš”, ë¹ ë¥¸ ë¹Œë“œ, ESM/CJS ë“€ì–¼ ì¶œë ¥ |
| **Module System** | ESM | - | í˜„ëŒ€ì  í‘œì¤€, ë” ë‚˜ì€ íŠ¸ë¦¬ ì‰ì´í‚¹ |

### 1.2 ì£¼ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬

#### Figma API Client: ë„¤ì´í‹°ë¸Œ fetch + ì»¤ìŠ¤í…€ ë˜í¼

```typescript
// ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì´ Node.js 20ì˜ ë„¤ì´í‹°ë¸Œ fetch ì‚¬ìš©
```

**ì„ íƒ ì´ìœ :**
- Node.js 20ì— ë„¤ì´í‹°ë¸Œ `fetch` í¬í•¨ (í´ë¦¬í•„ ë¶ˆí•„ìš”)
- Figma REST APIëŠ” ë‹¨ìˆœí•¨ (í•„ìš”í•œ ì—”ë“œí¬ì¸íŠ¸ 3-4ê°œ)
- ì»¤ìŠ¤í…€ í´ë¼ì´ì–¸íŠ¸ë¡œ ì •ë°€í•œ ì—ëŸ¬ ì²˜ë¦¬ì™€ ì¬ì‹œë„ ë¡œì§ ê°€ëŠ¥
- ë¶ˆí™•ì‹¤í•œ ìœ ì§€ë³´ìˆ˜ì˜ ì»¤ë®¤ë‹ˆí‹° íŒ¨í‚¤ì§€ ì˜ì¡´ì„± íšŒí”¼
- ì†ë„ ì œí•œê³¼ ì‘ë‹µ íƒ€ì…ì— ëŒ€í•œ ì™„ì „í•œ ì œì–´

**ê³ ë ¤í–ˆë˜ ëŒ€ì•ˆ:** `figma-api` npm íŒ¨í‚¤ì§€
- ê¸°ê° ì‚¬ìœ : 2ë…„ê°„ ì—…ë°ì´íŠ¸ ì—†ìŒ, ë¶ˆì™„ì „í•œ TypeScript íƒ€ì…, ë¶ˆí•„ìš”í•œ ì¶”ìƒí™”

#### ì´ë¯¸ì§€ ì²˜ë¦¬: Sharp

```
Package: sharp@0.33.x
Size: ~50MB (libvips ë°”ì´ë„ˆë¦¬ í¬í•¨)
```

**ì„ íƒ ì´ìœ :**
- ëŒ€ì•ˆë³´ë‹¤ 10-20ë°° ë¹ ë¦„ (ImageMagick, Jimp ëŒ€ë¹„)
- ëª¨ë“  í”Œë«í¼ìš© ì‚¬ì „ ë¹Œë“œ ë°”ì´ë„ˆë¦¬ê°€ í¬í•¨ëœ ë„¤ì´í‹°ë¸Œ libvips ë°”ì¸ë”©
- ìš°ìˆ˜í•œ TypeScript íƒ€ì… ì •ì˜
- ìŠ¤í”„ë¼ì´íŠ¸ ìƒì„±ì— ì™„ë²½í•œ í•©ì„± API
- í™œë°œí•œ ìœ ì§€ë³´ìˆ˜ (ì£¼ê°„ ë¦´ë¦¬ìŠ¤)
- ì¶”ê°€ ì„¤ì • ì—†ì´ Windows ë„¤ì´í‹°ë¸Œ ì§€ì›

**ë²¤ì¹˜ë§ˆí¬ ì°¸ê³ :**
```
ì‘ì—…: 100ê°œ ì´ë¯¸ì§€ë¥¼ 2048x2048 ìº”ë²„ìŠ¤ì— í•©ì„±
Sharp: ~200ms
Jimp: ~4000ms
```

#### Bin-packing ì•Œê³ ë¦¬ì¦˜: potpack

```
Package: potpack@2.0.0
Size: 2.3KB (ì˜ì¡´ì„± ì—†ìŒ)
```

**ì„ íƒ ì´ìœ :**
- ê²°ì •ë¡ ì  ì¶œë ¥ (ë™ì¼ ì…ë ¥ = ë™ì¼ ì¶œë ¥)
- í…ìŠ¤ì²˜ ì•„í‹€ë¼ìŠ¤ì— ìµœì í™” (ì •í™•íˆ ìš°ë¦¬ì˜ ì‚¬ìš© ì‚¬ë¡€)
- ê°„ë‹¨í•œ API: `potpack(boxes)`ê°€ `{w, h, fill}` ë°˜í™˜
- Mapbox ìœ ì§€ë³´ìˆ˜, í”„ë¡œë•ì…˜ ê²€ì¦ë¨
- ìˆ˜ì²œ ê°œì˜ ìŠ¤í”„ë¼ì´íŠ¸ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬

**ì•Œê³ ë¦¬ì¦˜ ë™ì‘:**
- ë†’ì´ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬ (ê²°ì •ë¡ ì )
- ì„ ë°˜ ê¸°ë°˜ bin-packing ì‚¬ìš©
- ì¬í˜„ ê°€ëŠ¥í•œ ë ˆì´ì•„ì›ƒ ë³´ì¥

**ê³ ë ¤í–ˆë˜ ëŒ€ì•ˆ:** `maxrects-packer`
- ë” ë§ì€ ê¸°ëŠ¥ì´ì§€ë§Œ ê¸°ë³¸ì ìœ¼ë¡œ ë¹„ê²°ì •ë¡ ì 
- ìš°ë¦¬ ìš”êµ¬ì‚¬í•­ì— ê³¼ë„í•¨

#### SVG ìµœì í™”: SVGO

```
Package: svgo@3.x
Size: ~150KB
```

**ì„ íƒ ì´ìœ :**
- SVG ìµœì í™”ì˜ ì—…ê³„ í‘œì¤€
- ì •ë°€í•œ ì œì–´ë¥¼ ìœ„í•œ ì„¤ì • ê°€ëŠ¥í•œ í”ŒëŸ¬ê·¸ì¸
- ì‹¬ë³¼ ìŠ¤í”„ë¼ì´íŠ¸ ìƒì„± íŒ¨í„´ ì²˜ë¦¬
- ì˜ ë¬¸ì„œí™”ë˜ê³  í™œë°œíˆ ìœ ì§€ë³´ìˆ˜ë¨

**ì„¤ì • ì „ëµ:**
```typescript
const svgoConfig = {
  plugins: [
    'preset-default',
    'removeDimensions',
    { name: 'removeViewBox', active: false }, // ì‹¬ë³¼ìš© viewBox ìœ ì§€
  ]
};
```

#### í•´ì‹±: Node.js crypto (ë‚´ì¥)

```
Package: ë‚´ì¥ crypto ëª¨ë“ˆ
```

**ì„ íƒ ì´ìœ :**
- SHA-256 ë„¤ì´í‹°ë¸Œ ì œê³µ
- ì™¸ë¶€ ì˜ì¡´ì„± ë¶ˆí•„ìš”
- ëª¨ë“  Node.js ë²„ì „ì—ì„œ ì¼ê´€ë¨
- ë¹ ë¥¸ ë„¤ì´í‹°ë¸Œ êµ¬í˜„

**ì‚¬ìš© íŒ¨í„´:**
```typescript
import { createHash } from 'node:crypto';
const hash = createHash('sha256').update(content).digest('hex').slice(0, 8);
```

#### CLI í”„ë ˆì„ì›Œí¬: Commander.js

```
Package: commander@12.x
Size: ~50KB
```

**ì„ íƒ ì´ìœ :**
- ê°€ì¥ ì„±ìˆ™í•œ CLI í”„ë ˆì„ì›Œí¬ (10ë…„+, GitHub ìŠ¤íƒ€ 25k+)
- ì¼ê¸‰ TypeScript ì§€ì›
- ìë™ ë„ì›€ë§ ìƒì„±
- í–¥í›„ í™•ì¥ì„±ì„ ìœ„í•œ ì„œë¸Œì»¤ë§¨ë“œ ì§€ì›
- ì£¼ìš” ë„êµ¬ë“¤ì´ ì‚¬ìš© (Vue CLI, Webpack CLI)

**ê³ ë ¤í–ˆë˜ ëŒ€ì•ˆ:**
- `yargs`: ë” ë¬´ê²ê³  ë³µì¡í•œ API
- `cac`: ë” ê°€ë³ì§€ë§Œ ìƒíƒœê³„ ì§€ì› ë¶€ì¡±
- `citty`: ë„ˆë¬´ ìƒˆë¡­ê³  ì œí•œëœ ì±„íƒ

#### Config ê²€ì¦: Zod

```
Package: zod@3.x
Size: ~60KB
```

**ì„ íƒ ì´ìœ :**
- TypeScript ìš°ì„  ìŠ¤í‚¤ë§ˆ ê²€ì¦
- ìŠ¤í‚¤ë§ˆì—ì„œ íƒ€ì… ì¶”ë¡  (ë‹¨ì¼ ì§„ì‹¤ ê³µê¸‰ì›)
- ê¸°ë³¸ì ìœ¼ë¡œ ìš°ìˆ˜í•œ ì—ëŸ¬ ë©”ì‹œì§€
- ë‚´ì¥ëœ ë³€í™˜ê³¼ ê¸°ë³¸ê°’
- ì˜ì¡´ì„± ì—†ìŒ

**ì‚¬ìš© íŒ¨í„´:**
```typescript
const ConfigSchema = z.object({
  figma: z.object({
    fileKey: z.string().min(1),
    page: z.string().min(1),
    scope: z.object({
      type: z.enum(['prefix']),
      value: z.string().min(1),
    }),
  }),
  output: z.object({
    dir: z.string().default('./assets/sprite'),
    name: z.string().default('sprite'),
  }),
  formats: z.object({
    png: z.object({
      enabled: z.boolean().default(true),
      scale: z.number().int().min(1).max(2).default(2),
      padding: z.number().int().min(0).default(2),
    }),
    svg: z.object({
      enabled: z.boolean().default(true),
      svgo: z.boolean().default(true),
    }),
  }),
  naming: z.object({
    idFormat: z.string().default('{name}-{size}-{style}{theme?--{theme}}'),
    sanitize: z.boolean().default(true),
  }),
});

type Config = z.infer<typeof ConfigSchema>; // ìë™ ìƒì„±ëœ íƒ€ì…
```

#### í…œí”Œë¦¿ ì—”ì§„: Handlebars

```
Package: handlebars@4.x
Size: ~80KB
```

**ì„ íƒ ì´ìœ :**
- ë¡œì§ ì—†ëŠ” í…œí”Œë¦¿ìœ¼ë¡œ ê´€ì‹¬ì‚¬ ë¶„ë¦¬ ê°•ì œ
- ì„±ëŠ¥ì„ ìœ„í•œ ì‚¬ì „ ì»´íŒŒì¼
- ì„±ìˆ™í•˜ê³  ì•ˆì •ì  (ìˆ˜ë…„ê°„ í˜¸í™˜ì„± íŒŒê´´ ë³€ê²½ ì—†ìŒ)
- SCSS ìƒì„±ì„ ìœ„í•œ ê°„ë‹¨í•œ ë¬¸ë²•
- ë°˜ë³µê³¼ ì¡°ê±´ì„ ìœ„í•œ ë‚´ì¥ í—¬í¼

**ê³ ë ¤í–ˆë˜ ëŒ€ì•ˆ:**
- í…œí”Œë¦¿ ë¦¬í„°ëŸ´: ë³µì¡í•œ SCSSì— ìœ ì§€ë³´ìˆ˜ ì–´ë ¤ì›€
- EJS: ë” ê°•ë ¥í•˜ì§€ë§Œ í…œí”Œë¦¿ì— ë„ˆë¬´ ë§ì€ ë¡œì§ í—ˆìš©
- Mustache: ë„ˆë¬´ ì œí•œì  (í—¬í¼ ì—†ìŒ)

#### í…ŒìŠ¤íŒ… í”„ë ˆì„ì›Œí¬: Vitest

```
Package: vitest@2.x
Size: ~5MB (dev dependency)
```

**ì„ íƒ ì´ìœ :**
- ë„¤ì´í‹°ë¸Œ ESMê³¼ TypeScript ì§€ì›
- Jest í˜¸í™˜ API (ìµìˆ™í•œ ë¬¸ë²•)
- ë„¤ì´í‹°ë¸Œ ESMìœ¼ë¡œ ë¹ ë¥¸ ì‹¤í–‰
- c8ì„ í†µí•œ ë‚´ì¥ ì»¤ë²„ë¦¬ì§€
- HMRì´ ìˆëŠ” ì›Œì¹˜ ëª¨ë“œ

**í…ŒìŠ¤íŠ¸ êµ¬ì¡°:**
```
tests/
â”œâ”€â”€ unit/           # ìˆœìˆ˜ í•¨ìˆ˜ í…ŒìŠ¤íŠ¸
â”œâ”€â”€ integration/    # ëª¨ë“ˆ ìƒí˜¸ì‘ìš© í…ŒìŠ¤íŠ¸
â””â”€â”€ fixtures/       # í…ŒìŠ¤íŠ¸ ë°ì´í„° (ëª¨ì˜ Figma ì‘ë‹µ)
```

### 1.3 ì˜ì¡´ì„± íŠ¸ë¦¬

```json
{
  "dependencies": {
    "commander": "^12.0.0",
    "sharp": "^0.33.0",
    "potpack": "^2.0.0",
    "svgo": "^3.2.0",
    "zod": "^3.22.0",
    "handlebars": "^4.7.0",
    "picocolors": "^1.0.0"
  },
  "devDependencies": {
    "typescript": "^5.4.0",
    "tsup": "^8.0.0",
    "vitest": "^2.0.0",
    "@types/node": "^20.0.0",
    "eslint": "^9.0.0",
    "prettier": "^3.2.0"
  }
}
```

**ì´ í”„ë¡œë•ì…˜ ì˜ì¡´ì„±:** 7ê°œ íŒ¨í‚¤ì§€
**ì˜ˆìƒ node_modules í¬ê¸°:** ~60MB (Sharpê°€ libvipsë¡œ ì¸í•´ ê°€ì¥ í¼)

---

## 2. ì•„í‚¤í…ì²˜ ì„¤ê³„

### 2.1 í”„ë¡œì íŠ¸ êµ¬ì¡°

```
figma-sprite-tool/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ cli/                    # CLI Layer
â”‚   â”‚   â”œâ”€â”€ index.ts            # ì§„ì…ì , Commander ì„¤ì •
â”‚   â”‚   â”œâ”€â”€ commands/
â”‚   â”‚   â”‚   â””â”€â”€ generate.ts     # Generate ì»¤ë§¨ë“œ í•¸ë“¤ëŸ¬
â”‚   â”‚   â””â”€â”€ output/
â”‚   â”‚       â”œâ”€â”€ logger.ts       # ì»¬ëŸ¬ ì½˜ì†” ì¶œë ¥
â”‚   â”‚       â””â”€â”€ progress.ts     # ì§„í–‰ë¥  í‘œì‹œê¸°
â”‚   â”‚
â”‚   â”œâ”€â”€ engine/                 # Core Engine Layer
â”‚   â”‚   â”œâ”€â”€ orchestrator.ts     # ë©”ì¸ ì›Œí¬í”Œë¡œìš° ì¡°ì •ì
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”‚   â”œâ”€â”€ loader.ts       # Config íŒŒì¼ ë¡œë”©
â”‚   â”‚   â”‚   â”œâ”€â”€ schema.ts       # Zod ìŠ¤í‚¤ë§ˆ
â”‚   â”‚   â”‚   â””â”€â”€ defaults.ts     # ê¸°ë³¸ê°’
â”‚   â”‚   â””â”€â”€ types/
â”‚   â”‚       â”œâ”€â”€ config.ts       # ì„¤ì • íƒ€ì…
â”‚   â”‚       â”œâ”€â”€ figma.ts        # Figma API íƒ€ì…
â”‚   â”‚       â””â”€â”€ sprite.ts       # ë‚´ë¶€ ìŠ¤í”„ë¼ì´íŠ¸ íƒ€ì…
â”‚   â”‚
â”‚   â”œâ”€â”€ processors/             # Specialized Processors
â”‚   â”‚   â”œâ”€â”€ figma/
â”‚   â”‚   â”‚   â”œâ”€â”€ client.ts       # Figma API í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ fetcher.ts      # ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ë¡œì§
â”‚   â”‚   â”‚   â””â”€â”€ parser.ts       # ì‘ë‹µ íŒŒì‹±
â”‚   â”‚   â”œâ”€â”€ sprite/
â”‚   â”‚   â”‚   â”œâ”€â”€ packer.ts       # Bin-packing ë˜í¼
â”‚   â”‚   â”‚   â”œâ”€â”€ png-generator.ts    # PNG ìŠ¤í”„ë¼ì´íŠ¸ í•©ì„±
â”‚   â”‚   â”‚   â””â”€â”€ svg-generator.ts    # SVG ì‹¬ë³¼ ìŠ¤í”„ë¼ì´íŠ¸
â”‚   â”‚   â”œâ”€â”€ output/
â”‚   â”‚   â”‚   â”œâ”€â”€ scss-generator.ts   # SCSS íŒŒì¼ ìƒì„±
â”‚   â”‚   â”‚   â”œâ”€â”€ json-generator.ts   # ë©”íƒ€ë°ì´í„° JSON
â”‚   â”‚   â”‚   â””â”€â”€ hash-calculator.ts  # ì½˜í…ì¸  í•´ì‹±
â”‚   â”‚   â””â”€â”€ validation/
â”‚   â”‚       â”œâ”€â”€ duplicate-detector.ts  # ì¤‘ë³µ ID ê°ì§€
â”‚   â”‚       â””â”€â”€ id-validator.ts        # ID í˜•ì‹ ê²€ì¦
â”‚   â”‚
â”‚   â”œâ”€â”€ templates/              # Handlebars Templates
â”‚   â”‚   â”œâ”€â”€ scss/
â”‚   â”‚   â”‚   â”œâ”€â”€ sprite.scss.hbs     # ë©”ì¸ ìŠ¤í”„ë¼ì´íŠ¸ íŒŒì¼
â”‚   â”‚   â”‚   â””â”€â”€ mixins.scss.hbs     # Mixin ì •ì˜
â”‚   â”‚   â””â”€â”€ svg/
â”‚   â”‚       â””â”€â”€ symbol-sprite.svg.hbs
â”‚   â”‚
â”‚   â””â”€â”€ utils/                  # Shared Utilities
â”‚       â”œâ”€â”€ fs.ts               # íŒŒì¼ ì‹œìŠ¤í…œ í—¬í¼ (Windows ì•ˆì „)
â”‚       â”œâ”€â”€ path.ts             # ê²½ë¡œ ì •ê·œí™”
â”‚       â”œâ”€â”€ retry.ts            # ì¬ì‹œë„ ë¡œì§ (ë°±ì˜¤í”„)
â”‚       â””â”€â”€ errors.ts           # ì»¤ìŠ¤í…€ ì—ëŸ¬ í´ë˜ìŠ¤
â”‚
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ unit/
â”‚   â”‚   â”œâ”€â”€ processors/
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”œâ”€â”€ integration/
â”‚   â””â”€â”€ fixtures/
â”‚       â”œâ”€â”€ figma-responses/    # ëª¨ì˜ API ì‘ë‹µ
â”‚       â”œâ”€â”€ icons/              # í…ŒìŠ¤íŠ¸ ì•„ì´ì½˜ PNG
â”‚       â””â”€â”€ expected/           # ì˜ˆìƒ ì¶œë ¥ íŒŒì¼
â”‚
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ tsup.config.ts
â””â”€â”€ vitest.config.ts
```

### 2.2 ê³„ì¸µ ë¶„ë¦¬

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CLI Layer                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Commander  â”‚  â”‚   Logger    â”‚  â”‚  Progress Display   â”‚ â”‚
â”‚  â”‚   Setup     â”‚  â”‚  (Colors)   â”‚  â”‚   (Spinners)        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                â”‚                     â”‚            â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                          â”‚                                   â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚                   â”‚   CLI API   â”‚                           â”‚
â”‚                   â”‚  (Public)   â”‚                           â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Engine Layer                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   Orchestrator                        â”‚   â”‚
â”‚  â”‚  - ì›Œí¬í”Œë¡œìš° ì¡°ì •                                       â”‚   â”‚
â”‚  â”‚  - ì—ëŸ¬ ì§‘ê³„                                           â”‚   â”‚
â”‚  â”‚  - ì§„í–‰ë¥  ë¦¬í¬íŒ…                                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â”‚                                    â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚    â”‚                    â”‚                    â”‚              â”‚
â”‚    â–¼                    â–¼                    â–¼              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚ â”‚Configâ”‚          â”‚Processorsâ”‚         â”‚  Types  â”‚         â”‚
â”‚ â”‚Loaderâ”‚          â”‚ Registry â”‚         â”‚(Shared) â”‚         â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Processor Layer                           â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Figma     â”‚  â”‚   Sprite    â”‚  â”‚      Output         â”‚  â”‚
â”‚  â”‚  Processor  â”‚  â”‚  Processor  â”‚  â”‚    Processors       â”‚  â”‚
â”‚  â”‚             â”‚  â”‚             â”‚  â”‚                     â”‚  â”‚
â”‚  â”‚ - Client    â”‚  â”‚ - Packer    â”‚  â”‚ - SCSS Generator    â”‚  â”‚
â”‚  â”‚ - Fetcher   â”‚  â”‚ - PNG Gen   â”‚  â”‚ - JSON Generator    â”‚  â”‚
â”‚  â”‚ - Parser    â”‚  â”‚ - SVG Gen   â”‚  â”‚ - Hash Calculator   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                    Validation                            â”‚â”‚
â”‚  â”‚  - Duplicate Detector  - ID Validator                   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 ë°ì´í„° í”Œë¡œìš°

```
1. INITIALIZATION (ì´ˆê¸°í™”)
   CLI Args â†’ Config Loader â†’ Zod Validation â†’ ValidConfig

2. FETCH PHASE (ê°€ì ¸ì˜¤ê¸°)
   Figma API Client
   â†’ Parse Response
   â†’ Validate IDs (Duplicate Detection)
   â†’ IconMetadata[]
   â†’ Download Images (ë³‘ë ¬)
   â†’ IconData[]

3. PROCESSING PHASE (ì²˜ë¦¬)
   potpack (Packing)
   â†’ PackedIcon[]
   â”œâ”€ PNG @1x Generator (Sharp)
   â”œâ”€ PNG @2x Generator (Sharp)
   â””â”€ SVG Symbol Generator (SVGO)

4. OUTPUT PHASE (ì¶œë ¥)
   PackedIcon[] + Metadata
   â”œâ”€ SCSS Generator (Handlebars)
   â”œâ”€ JSON Generator
   â””â”€ Hash Calculator (crypto)
```

### 2.4 í•µì‹¬ íƒ€ì… ì •ì˜

```typescript
// src/engine/types/config.ts
export interface SpriteConfig {
  figma: {
    fileKey: string;
    page: string;                  // ì•„ì´ì½˜ì´ ìœ„ì¹˜í•œ í˜ì´ì§€ ê²½ë¡œ
    scope: {
      type: 'prefix';
      value: string;               // í•„í„°ë§í•  prefix (ì˜ˆ: "ic/")
    };
  };
  output: {
    dir: string;
    name: string;                  // ì¶œë ¥ íŒŒì¼ëª… prefix (ì˜ˆ: "sprite")
  };
  formats: {
    png: {
      enabled: boolean;
      scale: 1 | 2;                // 1 ë˜ëŠ” 2 (retina)
      padding: number;             // ì•„ì´ì½˜ ê°„ íŒ¨ë”© (px)
    };
    svg: {
      enabled: boolean;
      svgo: boolean;               // SVGO ìµœì í™” í™œì„±í™” ì—¬ë¶€
    };
  };
  naming: {
    idFormat: string;              // ì•„ì´ì½˜ ID í¬ë§· í…œí”Œë¦¿
    sanitize: boolean;             // íŠ¹ìˆ˜ë¬¸ì ì œê±° ë° kebab-case ë³€í™˜
  };
}

// src/engine/types/sprite.ts
export interface IconData {
  id: string;           // ì •ê·œí™”ëœ ì•„ì´ì½˜ ID
  name: string;         // ì›ë³¸ Figma ë…¸ë“œ ì´ë¦„
  buffer: Buffer;       // PNG ì´ë¯¸ì§€ ë°ì´í„°
  width: number;
  height: number;
  nodeId: string;       // ì°¸ì¡°ìš© Figma ë…¸ë“œ ID
}

export interface PackedIcon extends IconData {
  x: number;            // ìŠ¤í”„ë¼ì´íŠ¸ ë‚´ X ìœ„ì¹˜
  y: number;            // ìŠ¤í”„ë¼ì´íŠ¸ ë‚´ Y ìœ„ì¹˜
}

export interface SpriteSheet {
  width: number;
  height: number;
  icons: PackedIcon[];
  hash: string;         // ë³€ê²½ ê°ì§€ìš© ì½˜í…ì¸  í•´ì‹œ
}
```

### 2.5 ì—ëŸ¬ ì²˜ë¦¬ ì•„í‚¤í…ì²˜

```typescript
// src/utils/errors.ts
export enum ErrorCode {
  // ì„¤ì • ì—ëŸ¬ (1xx)
  CONFIG_NOT_FOUND = 'E101',
  CONFIG_INVALID = 'E102',
  CONFIG_MISSING_REQUIRED = 'E103',

  // Figma API ì—ëŸ¬ (2xx)
  FIGMA_AUTH_FAILED = 'E201',
  FIGMA_FILE_NOT_FOUND = 'E202',
  FIGMA_RATE_LIMITED = 'E203',
  FIGMA_NODE_NOT_FOUND = 'E204',
  FIGMA_EXPORT_FAILED = 'E205',

  // ê²€ì¦ ì—ëŸ¬ (3xx)
  DUPLICATE_ICON_ID = 'E301',
  INVALID_ICON_ID = 'E302',
  EMPTY_ICON_SET = 'E303',

  // ì²˜ë¦¬ ì—ëŸ¬ (4xx)
  IMAGE_PROCESSING_FAILED = 'E401',
  SVG_OPTIMIZATION_FAILED = 'E402',
  PACKING_FAILED = 'E403',

  // ì¶œë ¥ ì—ëŸ¬ (5xx)
  WRITE_FAILED = 'E501',
  TEMPLATE_ERROR = 'E502',
  PERMISSION_DENIED = 'E503',
}

export class SpriteError extends Error {
  constructor(
    public readonly code: ErrorCode,
    message: string,
    public readonly context?: Record<string, unknown>,
    public readonly recoverable: boolean = false,
  ) {
    super(`[${code}] ${message}`);
    this.name = 'SpriteError';
  }

  toUserMessage(): string {
    // ì œì•ˆëœ ì¡°ì¹˜ì™€ í•¨ê»˜ ì‚¬ìš©ì ì¹œí™”ì  ë©”ì‹œì§€ ë°˜í™˜
  }
}

// ì¤‘ë³µ ê°ì§€ë¥¼ ìœ„í•œ ì‚¬ìš© ì˜ˆ
throw new SpriteError(
  ErrorCode.DUPLICATE_ICON_ID,
  `ì¤‘ë³µ ì•„ì´ì½˜ ID ê°ì§€: "${id}"`,
  {
    duplicateId: id,
    locations: [node1.name, node2.name],
    suggestion: 'Figmaì—ì„œ ëª¨ë“  ì•„ì´ì½˜ ì´ë¦„ì´ ê³ ìœ í•œì§€ í™•ì¸í•˜ì„¸ìš”'
  },
  false  // ë³µêµ¬ ë¶ˆê°€ - ëª…ì„¸ì— ë”°ë¼ í•˜ë“œ ì‹¤íŒ¨
);
```

---

## 3. ì¥ì  (Advantages)

### 3.1 ê¸°ìˆ ì  ì¥ì 

**ì •í™•ì„± (Correctness)**
- TypeScript strict ëª¨ë“œê°€ ì»´íŒŒì¼ íƒ€ì„ì— ì—ëŸ¬ í¬ì°©
- Zod ê²€ì¦ìœ¼ë¡œ ì •ë°€í•œ ì—ëŸ¬ ë©”ì‹œì§€ì™€ í•¨ê»˜ config ì •í™•ì„± ë³´ì¥
- potpackì˜ ê²°ì •ë¡ ì  ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ì¬í˜„ ê°€ëŠ¥í•œ ìŠ¤í”„ë¼ì´íŠ¸ ë ˆì´ì•„ì›ƒ ë³´ì¥
- ì „ì²´ì ì¸ ê°•í•œ íƒ€ì… ì‹œìŠ¤í…œìœ¼ë¡œ ëŸ°íƒ€ì„ íƒ€ì… ì—ëŸ¬ ë°©ì§€

**ì„±ëŠ¥**
- Sharpê°€ ìˆœìˆ˜ JavaScript ëŒ€ì•ˆë³´ë‹¤ 10-20ë°° ë¹ ë¦„
- ë„¤ì´í‹°ë¸Œ Node.js cryptoë¡œ ì™¸ë¶€ í•´ì‹± ì˜ì¡´ì„± ì œê±°
- potpackì´ í…ìŠ¤ì²˜ ì•„í‹€ë¼ìŠ¤ ìƒì„±ì— ìµœì í™”ë¨
- ë³‘ë ¬ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œë¡œ Figma API ì²˜ë¦¬ëŸ‰ ìµœëŒ€í™”

**ìœ ì§€ë³´ìˆ˜ì„± (Maintainability)**
- ëª…í™•í•œ 3ê³„ì¸µ ì•„í‚¤í…ì²˜ (CLI / Engine / Processors)
- ê° í”„ë¡œì„¸ì„œê°€ ë…ë¦½ì ì´ê³  ê²©ë¦¬ëœ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
- Handlebars í…œí”Œë¦¿ì´ í‘œí˜„ê³¼ ë¡œì§ì„ ë¶„ë¦¬
- ìµœì†Œí•œì˜ ì˜ì¡´ì„±ìœ¼ë¡œ ë³´ì•ˆ ê°ì‚¬ ë²”ìœ„ì™€ ì—…ë°ì´íŠ¸ ë¶€ë‹´ ê°ì†Œ

**ì—ëŸ¬ UX (ëª…í™•í•œ ì—ëŸ¬ UX)**
- êµ¬ì¡°í™”ëœ ì—ëŸ¬ ì½”ë“œë¡œ ë¬¸ì„œí™”ì™€ ê²€ìƒ‰ ê°€ëŠ¥
- ì»¨í…ìŠ¤íŠ¸ê°€ í’ë¶€í•œ ì—ëŸ¬ì— íŒŒì¼ ê²½ë¡œ, node ID, ì œì•ˆ í¬í•¨
- ì¤‘ë³µ ì‹œ ë¹ ë¥¸ ì‹¤íŒ¨ë¡œ ë‹¤ìš´ìŠ¤íŠ¸ë¦¼ í˜¼ë€ ë°©ì§€
- ì§„í–‰ë¥  í‘œì‹œê¸°ê°€ ì–´ëŠ ë‹¨ê³„ì—ì„œ ì‹¤íŒ¨í–ˆëŠ”ì§€ í‘œì‹œ

### 3.2 ê°œë°œì ê²½í—˜ ì¥ì 

- ESM ì „ì²´ ì‚¬ìš©ìœ¼ë¡œ í˜„ëŒ€ì  ë„êµ¬ì™€ íŠ¸ë¦¬ ì‰ì´í‚¹ ê°€ëŠ¥
- Vitestê°€ ê°œë°œ ì¤‘ ë¹ ë¥¸ í”¼ë“œë°± ì œê³µ
- tsupì´ TypeScript ë¹Œë“œì— ì„¤ì • ë¶ˆí•„ìš”
- pnpmì˜ strict ëª¨ë“œê°€ íŒ¬í…€ ì˜ì¡´ì„±ì„ ì¡°ê¸°ì— í¬ì°©

### 3.3 í”„ë¡œë•ì…˜ ì¥ì 

- Node.js 20 LTS ì§€ì› 2026ë…„ 4ì›”ê¹Œì§€
- ëª¨ë“  ì˜ì¡´ì„±ì´ ë³´ì•ˆ íŒ¨ì¹˜ì™€ í•¨ê»˜ í™œë°œíˆ ìœ ì§€ë³´ìˆ˜ë¨
- Sharpê°€ CI/CD í™˜ê²½ìš© ì‚¬ì „ ë¹Œë“œ ë°”ì´ë„ˆë¦¬ í¬í•¨
- pkgë‚˜ node SEAë¥¼ í†µí•œ ë‹¨ì¼ ì‹¤í–‰ íŒŒì¼ ê°€ëŠ¥

---

## 4. ì˜ˆìƒë˜ëŠ” í•œê³„ì  (Expected Limitations)

### 4.1 ê¸°ìˆ ì  ì œì•½

| ì œì•½ì‚¬í•­ | ì˜í–¥ | ì™„í™” ë°©ë²• |
|---------|-----|----------|
| Sharp ë°”ì´ë„ˆë¦¬ í¬ê¸° (~50MB) | ë” í° node_modules | ì„±ëŠ¥ì„ ìœ„í•œ íŠ¸ë ˆì´ë“œì˜¤í”„ë¡œ ìˆ˜ìš© |
| Figma API ì†ë„ ì œí•œ | ë‚´ë³´ë‚´ê¸° 30 ìš”ì²­/ë¶„ | ì§€ìˆ˜ ë°±ì˜¤í”„ êµ¬í˜„ |
| ë‹¨ì¼ ìŠ¤ë ˆë“œ Node.js | í° ìŠ¤í”„ë¼ì´íŠ¸ ì‹œíŠ¸ê°€ ëŠë¦´ ìˆ˜ ìˆìŒ | >1000 ì•„ì´ì½˜ì— ì›Œì»¤ ìŠ¤ë ˆë“œ ì‚¬ìš© |
| ëŒ€í˜• ìŠ¤í”„ë¼ì´íŠ¸ ë©”ëª¨ë¦¬ ì‚¬ìš© | Node.js í™ ì œí•œì— ë„ë‹¬í•  ìˆ˜ ìˆìŒ | ë§¤ìš° í° ì‹œíŠ¸ì— ìŠ¤íŠ¸ë¦¬ë° êµ¬í˜„ |

### 4.2 ìš´ì˜ ì œì•½

**Figma API ì œì•½:**
- ë³€ê²½ ê°ì§€ë¥¼ ìœ„í•œ ì›¹í›… ì§€ì› ì—†ìŒ (í´ë§ í•„ìš”)
- ë‚´ë³´ë‚´ê¸° URLì´ 14ì¼ í›„ ë§Œë£Œ
- ì†ë„ ì œí•œìœ¼ë¡œ ì‹ ì¤‘í•œ ìš”ì²­ ê´€ë¦¬ í•„ìš”

**í”Œë«í¼ ê³ ë ¤ì‚¬í•­:**
- Windows ê¸´ ê²½ë¡œ ì§€ì›ì— ëª…ì‹œì  ì„¤ì • í•„ìš”
- ì¼ë¶€ CI í™˜ê²½ì—ì„œ Sharp ì¬ë¹Œë“œ í•„ìš”í•  ìˆ˜ ìˆìŒ
- Node.js 20 í•„ìˆ˜ (Node 18 LTS í´ë°± ì—†ìŒ)

### 4.3 ìŠ¤ì½”í”„ ì œì•½ (MVP)

ì´ˆê¸° ì•„í‚¤í…ì²˜ì— í¬í•¨ë˜ì§€ ì•ŠìŒ:
- íŒŒì¼ ë³€ê²½ì„ ìœ„í•œ ì›Œì¹˜ ëª¨ë“œ
- ì¦ë¶„ ìƒì„± (ë³€ê²½ëœ ì•„ì´ì½˜ë§Œ ì¬ìƒì„±)
- ì»¤ìŠ¤í…€ bin-packing ì•Œê³ ë¦¬ì¦˜
- ë‹¤ì¤‘ ìŠ¤í”„ë¼ì´íŠ¸ ì‹œíŠ¸ ì¶œë ¥ (í° ì„¸íŠ¸ ë¶„í• )
- ì¸í„°ë™í‹°ë¸Œ CLI í”„ë¡¬í”„íŠ¸

---

## 5. ì£¼ìš” ê²°ì • ê·¼ê±°

### 5.1 Node.js 20 LTS ì„ íƒ

**Node.jsë¥¼ ì„ íƒí•œ ì´ìœ :**
- **Deno**: ìš°ìˆ˜í•œ TypeScript ì§€ì›ì´ì§€ë§Œ ì‘ì€ ìƒíƒœê³„, Sharp ì™„ì „ í˜¸í™˜ ì•ˆë¨
- **Bun**: ë¹ ë¥´ì§€ë§Œ ì•„ì§ ì„±ìˆ™ ì¤‘, í”„ë¡œë•ì…˜ ì•ˆì •ì„± ìš°ë ¤
- **Node.js 18**: ì•ˆì •ì ì´ì§€ë§Œ ë„¤ì´í‹°ë¸Œ fetch ì—†ìŒ, í´ë¦¬í•„ í•„ìš”
- **Node.js 20**: âœ… ë„¤ì´í‹°ë¸Œ fetch, ì•ˆì •ì  ESM, 2026ë…„ê¹Œì§€ LTS

**í™œìš©ë˜ëŠ” ì£¼ìš” Node.js 20 ê¸°ëŠ¥:**
- ë„¤ì´í‹°ë¸Œ `fetch()` API - axios/node-fetch ì˜ì¡´ì„± ì œê±°
- ì•ˆì •ì  ESM - ì‹¤í—˜ì  í”Œë˜ê·¸ ì—†ëŠ” í˜„ëŒ€ì  ëª¨ë“ˆ ì‹œìŠ¤í…œ
- V8 ì—”ì§„ì˜ ì„±ëŠ¥ ê°œì„ 

### 5.2 Sharp ì„ íƒ (ì´ë¯¸ì§€ ì²˜ë¦¬)

**ë¹„êµ ë§¤íŠ¸ë¦­ìŠ¤:**

| ë¼ì´ë¸ŒëŸ¬ë¦¬ | ì†ë„ | ë©”ëª¨ë¦¬ | íƒ€ì… | ìœ ì§€ë³´ìˆ˜ | Windows |
|-----------|------|--------|------|---------|---------|
| **Sharp** | ê°€ì¥ ë¹ ë¦„ | ë‚®ìŒ | ìš°ìˆ˜ | ì£¼ê°„ ì—…ë°ì´íŠ¸ | ë„¤ì´í‹°ë¸Œ |
| Jimp | ê°€ì¥ ëŠë¦¼ | ë†’ìŒ | ì¢‹ìŒ | ì›”ê°„ | ìˆœìˆ˜ JS |
| ImageMagick | ë¹ ë¦„ | ì¤‘ê°„ | ìˆ˜ë™ | ì‹œìŠ¤í…œ ì˜ì¡´ | ì„¤ì¹˜ í•„ìš” |
| Canvas | ì¤‘ê°„ | ë†’ìŒ | ì¢‹ìŒ | ì›”ê°„ | ë¹Œë“œ í•„ìš” |

**Sharp ì„ íƒ ì´ìœ :**
1. **ì„±ëŠ¥**: libvipsê°€ ë°°ì¹˜ ì‘ì—…ì— ìµœì í™”ë¨
2. **ë©”ëª¨ë¦¬**: ìŠ¤íŠ¸ë¦¬ë° ì•„í‚¤í…ì²˜ë¡œ í° ì´ë¯¸ì§€ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬
3. **ì‹ ë¢°ì„±**: Cloudinary, Imgix ë“± ì£¼ìš” ì„œë¹„ìŠ¤ì—ì„œ ì‚¬ìš©
4. **í•©ì„± API**: ìŠ¤í”„ë¼ì´íŠ¸ ì‹œíŠ¸ ìƒì„±ì— ì™„ë²½í•˜ê²Œ ë§ìŒ

### 5.3 potpack ì„ íƒ (Bin-packing)

**ì•Œê³ ë¦¬ì¦˜ ë¹„êµ:**

| ë¼ì´ë¸ŒëŸ¬ë¦¬ | ê²°ì •ë¡ ì„± | í¬ê¸° | ê¸°ëŠ¥ | ì‚¬ìš© ì‚¬ë¡€ |
|-----------|---------|------|------|----------|
| **potpack** | ë³´ì¥ë¨ | 2KB | ìµœì†Œ | í…ìŠ¤ì²˜ ì•„í‹€ë¼ìŠ¤ |
| maxrects-packer | ì„¤ì • ê°€ëŠ¥ | 15KB | ë§ì€ ì˜µì…˜ | ê²Œì„ ì—”ì§„ |
| bin-pack | ë³´ì¥ ì•ˆë¨ | 5KB | ê¸°ë³¸ | ë²”ìš© |
| shelf-pack | ë³´ì¥ë¨ | 8KB | ë™ì  | Mapbox GL |

**potpack ì„ íƒ ì´ìœ :**
1. **ì„¤ê³„ìƒ ê²°ì •ë¡ ì **: ë™ì¼ ì…ë ¥ì´ í•­ìƒ ë™ì¼ ì¶œë ¥ ìƒì„±
2. **Mapbox ê³„ë³´**: Mapbox GL JSì—ì„œ ê²€ì¦ë¨
3. **ìµœì†Œí•œì˜ í‘œë©´ì **: ì ì€ ì½”ë“œ = ì ì€ ë²„ê·¸
4. **ì™„ë²½í•œ ë§ì¶¤**: ì •í™•íˆ ìš°ë¦¬ ì‚¬ìš© ì‚¬ë¡€ë¥¼ ìœ„í•´ ì„¤ê³„ë¨

**ê²°ì •ë¡ ì„± ê²€ì¦:**
```typescript
// ì´ í…ŒìŠ¤íŠ¸ëŠ” í•­ìƒ í†µê³¼í•´ì•¼ í•¨
const input = [{ w: 100, h: 50 }, { w: 80, h: 80 }, { w: 40, h: 40 }];
const result1 = potpack(input);
const result2 = potpack(input);
assert.deepEqual(result1, result2); // ë³´ì¥ë¨
```

### 5.4 ì•„í‚¤í…ì²˜ ê²°ì •: 3ê³„ì¸µ ë¶„ë¦¬

**CLIì™€ Engineì„ ë¶„ë¦¬í•œ ì´ìœ :**

1. **í…ŒìŠ¤íŠ¸ ê°€ëŠ¥ì„±**: Engineì„ CLI ëª¨í‚¹ ì—†ì´ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
2. **ì¬ì‚¬ìš©ì„±**: Engineì„ í”„ë¡œê·¸ë˜ë° ë°©ì‹ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥
3. **í–¥í›„ ëŒ€ë¹„**: GUIë‚˜ API ë˜í¼ ì¶”ê°€ ìš©ì´
4. **ì±…ì„ ëª…í™•ì„±**: CLIëŠ” I/O ì²˜ë¦¬, Engineì€ ë¡œì§ ì²˜ë¦¬

```typescript
// Engine APIëŠ” í”„ë ˆì„ì›Œí¬ ë…ë¦½ì 
interface SpriteEngine {
  generate(config: SpriteConfig): Promise<GenerationResult>;
  validate(config: SpriteConfig): ValidationResult;
  preview(config: SpriteConfig): Promise<PreviewResult>;
}

// CLIëŠ” ë‹¨ìˆœí•œ ì–‡ì€ ë˜í¼
async function generateCommand(options: CLIOptions) {
  const config = await loadConfig(options.config);
  const engine = new SpriteEngine();
  const result = await engine.generate(config);
  displayResult(result);
}
```

---

## 6. êµ¬í˜„ ë¡œë“œë§µ

êµ¬í˜„ ë¡œë“œë§µì€ **[3_IMPLEMENT.md](./3_IMPLEMENT.md)**ë¥¼ ì°¸ê³ í•˜ì„¸ìš”.

**ì´ ì˜ˆìƒ ê¸°ê°„:** 2-3ì£¼ (7ê°œ Phase)

---

## 7. ì°¸ê³  ìë£Œ

### ì»¤ë§¨ë“œ ì˜ˆì œ

```bash
# ê¸°ë³¸ ìƒì„±
figma-sprite generate -c sprite.config.json

# ìƒì„¸ ì¶œë ¥ê³¼ í•¨ê»˜
figma-sprite generate -c sprite.config.json --verbose

# ë“œë¼ì´ ëŸ° (ë¯¸ë¦¬ë³´ê¸°ë§Œ)
figma-sprite generate -c sprite.config.json --dry-run

# ì»¤ìŠ¤í…€ ì¶œë ¥ ë””ë ‰í† ë¦¬
figma-sprite generate -c sprite.config.json -o ./assets/sprites
```

### ì„¤ì • ì˜ˆì œ

```json
{
  "figma": {
    "fileKey": "AbCdEf123456",
    "page": "Design System / Icons",
    "scope": {
      "type": "prefix",
      "value": "ic/"
    }
  },
  "output": {
    "dir": "assets/sprite",
    "name": "sprite"
  },
  "formats": {
    "png": {
      "enabled": true,
      "scale": 2,
      "padding": 2
    },
    "svg": {
      "enabled": true,
      "svgo": true
    }
  },
  "naming": {
    "idFormat": "{name}-{size}-{style}{theme?--{theme}}",
    "sanitize": true
  }
}
```

### ì¶œë ¥ íŒŒì¼

```
sprites/
â”œâ”€â”€ icon.png          # 1x ìŠ¤í”„ë¼ì´íŠ¸ ì‹œíŠ¸
â”œâ”€â”€ icon@2x.png       # 2x ë ˆí‹°ë‚˜ ìŠ¤í”„ë¼ì´íŠ¸ ì‹œíŠ¸
â”œâ”€â”€ icon.svg          # SVG ì‹¬ë³¼ ìŠ¤í”„ë¼ì´íŠ¸
â”œâ”€â”€ _icon-sprite.scss # ë©”ì¸ SCSS íŒŒì¼
â”œâ”€â”€ _icon-mixins.scss # Mixin ì •ì˜
â””â”€â”€ icon.json         # í•´ì‹œê°€ í¬í•¨ëœ ë©”íƒ€ë°ì´í„°
```
